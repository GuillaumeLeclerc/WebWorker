function sendMessage(a,b){"use strict";var c=[a];"undefined"!=typeof b&&c.push(b),postMessage(c)}function define(a,b){"use strict";if(null!==defined)return sendMessage("error","You can define your worker only once !");for(var c in a)importScripts(a[c]);b&&"object"==typeof b||sendMessage("error",new Error("The second argument of the define function should be an object"));var d=[];for(var e in b)"load"!==e&&"loadSync"!==e&&(e=e.replace(/Sync$/,""),d.push(e));var f=function(){sendMessage("loaded",d)};if(b.loadSync&&"function"==typeof b.loadSync)try{b.loadSync(),f()}catch(g){sendMessage("error",g)}else b.load&&"function"==typeof b.load?b.load(function(a){a?sendMessage("error",a):f()}):f();defined=b}var defined=null,eventListeners={},handler={load:function(a){"use strict";try{importScripts(a)}catch(b){sendMessage("error",{name:b.name,message:b.message})}},work:function(a){"use strict";var b=a[0],c=b+"Sync",d=a[1],e=function(a){sendMessage("progress",a)},f=function(a){for(var b in a)"function"==typeof a[b]&&(eventListeners["custom-"+b]=a[b]);sendMessage("eventsRegistered")},g=function(a){return eventListeners={},sendMessage("finishedWorking",a)};if(sendMessage("startWorking"),defined[c]&&"function"==typeof defined[c])try{var h=defined[c](d,e,f);g(h)}catch(i){return sendMessage("error",i)}else{if(!defined[b]||"function"!=typeof defined[b])return sendMessage("error",b+" and "+c+" are not available in the worker");defined[b](d,function(a,b){return a?sendMessage("error",a):void g(b)},e,f)}}};self.onmessage=function(a){"use strict";var b=a.data,c=b[0],d=b[1];"function"==typeof handler[c]?handler[c](d):"function"==typeof eventListeners[c]&&eventListeners[c](d)},sendMessage("preloaded");